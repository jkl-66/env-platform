# ç¯å¢ƒä¿æŠ¤å›¾åƒç”Ÿæˆå™¨

åŸºäº Stable Diffusion 3.5 Large Turbo æ¨¡å‹çš„ç¯å¢ƒä¿æŠ¤è­¦ç¤ºå›¾åƒç”Ÿæˆå·¥å…·

## åŠŸèƒ½ç‰¹ç‚¹

- ğŸŒ **ç¯å¢ƒä¸»é¢˜ä¸“ç”¨**: ä¸“é—¨é’ˆå¯¹ç¯å¢ƒä¿æŠ¤ä¸»é¢˜ä¼˜åŒ–çš„å›¾åƒç”Ÿæˆ
- ğŸ—£ï¸ **è‡ªç„¶è¯­è¨€è¾“å…¥**: æ”¯æŒä¸­æ–‡å’Œè‹±æ–‡è‡ªç„¶è¯­è¨€æè¿°
- ğŸ“‹ **å†…ç½®æç¤ºè¯æ¨¡æ¿**: 10+ ç§ç¯å¢ƒä¸»é¢˜çš„é¢„è®¾æ¨¡æ¿
- ğŸ¨ **å¤šç§é£æ ¼é¢„è®¾**: çºªå®ã€è‰ºæœ¯ã€ç§‘å­¦ç­‰å¤šç§è§†è§‰é£æ ¼
- âš™ï¸ **å¯è°ƒèŠ‚å‚æ•°**: æ”¯æŒè´¨é‡ã€é€Ÿåº¦ã€å°ºå¯¸ç­‰å‚æ•°è°ƒæ•´
- ğŸ“ **æ‰¹é‡ç”Ÿæˆ**: æ”¯æŒæ‰¹é‡ç”Ÿæˆå¤šä¸ªä¸»é¢˜çš„å›¾åƒ

## ç¯å¢ƒä¸»é¢˜

| ä¸»é¢˜ | æè¿° | å…³é”®è¯ |
|------|------|--------|
| ç©ºæ°”æ±¡æŸ“ | å·¥ä¸šæ±¡æŸ“ã€é›¾éœ¾ã€ç©ºæ°”è´¨é‡ | æ±¡æŸ“ã€é›¾éœ¾ã€å·¥å‚çƒŸå›± |
| æ°´æ±¡æŸ“ | æ²³æµæ±¡æŸ“ã€å·¥ä¸šåºŸæ°´ã€æœ‰æ¯’ç‰©è´¨ | æ°´æ±¡æŸ“ã€å·¥ä¸šåºŸæ°´ã€æ²³æµæ±¡æŸ“ |
| æ£®æ—ç ä¼ | å¤§è§„æ¨¡ç ä¼ã€ç”Ÿæ€ç ´åã€æ –æ¯åœ°ä¸§å¤± | æ£®æ—ç ä¼ã€æ¯æ—ã€ç”Ÿæ€ç ´å |
| æ°”å€™å˜åŒ– | å…¨çƒå˜æš–ã€å†°å·èåŒ–ã€æµ·å¹³é¢ä¸Šå‡ | æ°”å€™å˜åŒ–ã€å…¨çƒå˜æš–ã€å†°å·èåŒ– |
| å¡‘æ–™æ±¡æŸ“ | æµ·æ´‹åƒåœ¾ã€å¾®å¡‘æ–™ã€æµ·æ´‹ç”Ÿç‰©å½±å“ | å¡‘æ–™æ±¡æŸ“ã€æµ·æ´‹åƒåœ¾ã€å¾®å¡‘æ–™ |
| å¯å†ç”Ÿèƒ½æº | å¤ªé˜³èƒ½ã€é£èƒ½ã€æ¸…æ´æŠ€æœ¯ | å¯å†ç”Ÿèƒ½æºã€å¤ªé˜³èƒ½ã€é£èƒ½ |
| åºŸç‰©ç®¡ç† | åƒåœ¾å¡«åŸ‹ã€å›æ”¶ã€åºŸç‰©å¤„ç† | åƒåœ¾å¤„ç†ã€å›æ”¶ã€åºŸç‰©ç®¡ç† |
| ç”Ÿç‰©å¤šæ ·æ€§ | æ¿’å±ç‰©ç§ã€æ –æ¯åœ°ç ´åã€ç”Ÿæ€ç³»ç»Ÿ | ç”Ÿç‰©å¤šæ ·æ€§ã€æ¿’å±ç‰©ç§ã€ç”Ÿæ€ä¿æŠ¤ |
| åŸå¸‚æ±¡æŸ“ | äº¤é€šæ±¡æŸ“ã€åŸå¸‚çƒ­å²›ã€ç©ºæ°”è´¨é‡ | åŸå¸‚æ±¡æŸ“ã€äº¤é€šæ±¡æŸ“ã€åŸå¸‚ç¯å¢ƒ |
| åœŸå£¤é€€åŒ– | è’æ¼ åŒ–ã€åœŸåœ°ä¾µèš€ã€å†œä¸šæ±¡æŸ“ | åœŸå£¤é€€åŒ–ã€è’æ¼ åŒ–ã€åœŸåœ°ä¾µèš€ |

## å®‰è£…è¦æ±‚

```bash
# å®‰è£…ä¾èµ–
pip install torch torchvision torchaudio --index-url https://download.pytorch.org/whl/cu118
pip install diffusers transformers accelerate pillow

# ç¡®ä¿æœ‰è¶³å¤Ÿçš„ GPU å†…å­˜ (æ¨è 8GB+)
```

## å¿«é€Ÿå¼€å§‹

### 1. åŸºæœ¬ä½¿ç”¨

```python
from environmental_image_generator import EnvironmentalImageGenerator

# åˆå§‹åŒ–ç”Ÿæˆå™¨
generator = EnvironmentalImageGenerator(
    model_id="stabilityai/stable-diffusion-3.5-large-turbo",
    device="auto"
)

# ç”Ÿæˆå›¾åƒ
results = generator.generate_image(
    user_input="å·¥å‚æ’æ”¾é»‘çƒŸæ±¡æŸ“ç©ºæ°”çš„åœºæ™¯",
    guidance_scale=7.5,
    num_inference_steps=28,
    height=1024,
    width=1024
)

if results['success']:
    print(f"å›¾åƒå·²ä¿å­˜åˆ°: {results['image_paths'][0]}")
else:
    print(f"ç”Ÿæˆå¤±è´¥: {results['error']}")
```

### 2. ä½¿ç”¨æ¼”ç¤ºè„šæœ¬

```bash
# è¿è¡Œäº¤äº’å¼æ¼”ç¤º
python demo_environmental_generator.py
```

æ¼”ç¤ºè„šæœ¬æä¾›ä»¥ä¸‹åŠŸèƒ½ï¼š
- é¢„è®¾æ¨¡æ¿ç”Ÿæˆ
- è‡ªç„¶è¯­è¨€è¾“å…¥ç”Ÿæˆ
- æ‰¹é‡ç”Ÿæˆæ¼”ç¤º
- é…ç½®ä¿¡æ¯æŸ¥çœ‹

### 3. è¿è¡Œæµ‹è¯•

```bash
# è¿è¡ŒåŠŸèƒ½æµ‹è¯•
python test_environmental_generator.py
```

## é…ç½®æ–‡ä»¶

é…ç½®æ–‡ä»¶ä½äº `config/environmental_prompts.json`ï¼ŒåŒ…å«ï¼š

- **environmental_prompts**: ç¯å¢ƒä¸»é¢˜æç¤ºè¯æ¨¡æ¿
- **generation_settings**: ç”Ÿæˆè´¨é‡è®¾ç½®ï¼ˆé»˜è®¤ã€é«˜è´¨é‡ã€å¿«é€Ÿã€æ‰¹é‡ï¼‰
- **style_presets**: é£æ ¼é¢„è®¾ï¼ˆå†™å®ã€çºªå®ã€è‰ºæœ¯ã€ç§‘å­¦ã€æˆå‰§æ€§ï¼‰
- **quality_enhancers**: è´¨é‡å¢å¼ºè¯
- **negative_prompts**: è´Ÿé¢æç¤ºè¯

### è‡ªå®šä¹‰é…ç½®

æ‚¨å¯ä»¥ç¼–è¾‘é…ç½®æ–‡ä»¶æ¥ï¼š
- æ·»åŠ æ–°çš„ç¯å¢ƒä¸»é¢˜
- ä¿®æ”¹ç°æœ‰æç¤ºè¯æ¨¡æ¿
- è°ƒæ•´ç”Ÿæˆå‚æ•°
- æ·»åŠ æ–°çš„é£æ ¼é¢„è®¾

## ç”Ÿæˆå‚æ•°è¯´æ˜

| å‚æ•° | è¯´æ˜ | æ¨èå€¼ |
|------|------|--------|
| guidance_scale | æç¤ºè¯éµå¾ªåº¦ | 7.5 (æ ‡å‡†), 9.0 (é«˜è´¨é‡) |
| num_inference_steps | æ¨ç†æ­¥æ•° | 28 (æ ‡å‡†), 35 (é«˜è´¨é‡), 20 (å¿«é€Ÿ) |
| height/width | å›¾åƒå°ºå¯¸ | 1024x1024 (é«˜è´¨é‡), 768x768 (å¿«é€Ÿ) |
| num_images | ç”Ÿæˆæ•°é‡ | 1 (å•å¼ ), 4 (æ‰¹é‡) |

## ä½¿ç”¨ç¤ºä¾‹

### ä¸­æ–‡è‡ªç„¶è¯­è¨€è¾“å…¥

```python
# ç©ºæ°”æ±¡æŸ“ä¸»é¢˜
results = generator.generate_image("å·¥å‚çƒŸå›±å†’å‡ºé»‘çƒŸï¼ŒåŸå¸‚è¢«é›¾éœ¾ç¬¼ç½©")

# æµ·æ´‹æ±¡æŸ“ä¸»é¢˜
results = generator.generate_image("æµ·æ´‹ä¸­æ¼‚æµ®ç€å¤§é‡å¡‘æ–™åƒåœ¾ï¼Œæµ·é¾Ÿè¢«å¡‘æ–™è¢‹ç¼ ç»•")

# æ£®æ—ç ´åä¸»é¢˜
results = generator.generate_image("å¤§ç‰‡æ£®æ—è¢«ç ä¼ï¼Œåªå‰©ä¸‹å…‰ç§ƒç§ƒçš„æ ‘æ¡©")
```

### è‹±æ–‡è‡ªç„¶è¯­è¨€è¾“å…¥

```python
# æ°”å€™å˜åŒ–ä¸»é¢˜
results = generator.generate_image("melting glaciers due to global warming, polar bears on shrinking ice")

# å¯å†ç”Ÿèƒ½æºä¸»é¢˜
results = generator.generate_image("solar panels and wind turbines in a clean energy landscape")
```

### ä½¿ç”¨é¢„è®¾æ¨¡æ¿

```python
import json

# åŠ è½½é…ç½®
with open('config/environmental_prompts.json', 'r', encoding='utf-8') as f:
    config = json.load(f)

# ä½¿ç”¨ç©ºæ°”æ±¡æŸ“æ¨¡æ¿
air_pollution = config['environmental_prompts']['air_pollution']
prompt = air_pollution['base_prompt']
style = config['style_presets']['documentary']

results = generator.generate_image(f"{prompt}, {style}")
```

## è¾“å‡ºæ–‡ä»¶

ç”Ÿæˆçš„å›¾åƒä¿å­˜åœ¨ `outputs/environmental_images/` ç›®å½•ä¸‹ï¼š

```
outputs/environmental_images/
â”œâ”€â”€ 20241201_143022_air_pollution/
â”‚   â”œâ”€â”€ image_001.png
â”‚   â””â”€â”€ generation_report.json
â”œâ”€â”€ 20241201_143156_water_pollution/
â”‚   â”œâ”€â”€ image_001.png
â”‚   â””â”€â”€ generation_report.json
â””â”€â”€ ...
```

æ¯æ¬¡ç”Ÿæˆéƒ½ä¼šåˆ›å»ºä¸€ä¸ªå¸¦æ—¶é—´æˆ³çš„æ–‡ä»¶å¤¹ï¼ŒåŒ…å«ï¼š
- ç”Ÿæˆçš„å›¾åƒæ–‡ä»¶ (PNG æ ¼å¼)
- ç”ŸæˆæŠ¥å‘Š (JSON æ ¼å¼ï¼ŒåŒ…å«å‚æ•°å’Œå…ƒæ•°æ®)

## æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

1. **CUDA å†…å­˜ä¸è¶³**
   ```python
   # ä½¿ç”¨è¾ƒå°çš„å›¾åƒå°ºå¯¸
   generator.generate_image(prompt, height=512, width=512)
   ```

2. **æ¨¡å‹ä¸‹è½½å¤±è´¥**
   ```python
   # æ£€æŸ¥ç½‘ç»œè¿æ¥å’Œ Hugging Face è®¿é—®
   # ç¡®ä¿æœ‰è¶³å¤Ÿçš„ç£ç›˜ç©ºé—´ (æ¨¡å‹çº¦ 8GB)
   ```

3. **ç”Ÿæˆé€Ÿåº¦æ…¢**
   ```python
   # ä½¿ç”¨å¿«é€Ÿè®¾ç½®
   generator.generate_image(
       prompt, 
       num_inference_steps=20,
       height=768, 
       width=768
   )
   ```

### æ€§èƒ½ä¼˜åŒ–

- ä½¿ç”¨ GPU åŠ é€Ÿ (CUDA)
- è°ƒæ•´æ¨ç†æ­¥æ•°å’Œå›¾åƒå°ºå¯¸
- æ‰¹é‡ç”Ÿæˆå¤šå¼ å›¾åƒ
- ä½¿ç”¨æ··åˆç²¾åº¦ (è‡ªåŠ¨å¯ç”¨)

## è®¸å¯è¯

æœ¬é¡¹ç›®éµå¾ª MIT è®¸å¯è¯ã€‚ä½¿ç”¨çš„ Stable Diffusion æ¨¡å‹è¯·éµå¾ªç›¸åº”çš„è®¸å¯è¯æ¡æ¬¾ã€‚

## è´¡çŒ®

æ¬¢è¿æäº¤ Issue å’Œ Pull Request æ¥æ”¹è¿›è¿™ä¸ªé¡¹ç›®ï¼

---

**æ³¨æ„**: ç”Ÿæˆçš„å›¾åƒä»…ç”¨äºæ•™è‚²å’Œç¯ä¿å®£ä¼ ç›®çš„ï¼Œè¯·éµå®ˆç›¸å…³æ³•å¾‹æ³•è§„ã€‚